<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">

<th:block th:replace="~{layout/main :: page(title='Квесты', appMain=~{::appMain}, appMainFluid=~{::appMainFluid}, activeMenuItem='quests')}">

    <!-- Контент для container -->
    <appMain>
        <div class="container-fluid">
            <!-- Сетка карточек 2x2 -->
            <div class="row">
                <div th:each="quest, iter : ${quests}" class="col-lg-6 col-md-6 col-sm-12 mb-4">
                    <div class="card h-100 shadow-sm">
                        <!-- Изображение квеста - ИЗМЕНЕНО -->
                        <div class="card-img-top-container" style="height: 200px; overflow: hidden; display: flex; justify-content: center; align-items: center; background-color: #f8f9fa;">
                            <img th:src="${'/images/' + (quest.imgPath != null ? quest.imgPath : 'quests/default_img.jpg')}"
                                 th:alt="${quest.questName}"
                                 class="card-img-top"
                                 style="object-fit: contain; max-height: 100%; max-width: 100%;">
                        </div>

                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title" th:text="${quest.questName}">Название квеста</h5>

                            <p class="card-text flex-grow-1" th:text="${quest.description}">Описание квеста</p>

                            <div class="mt-auto">
                                <p th:if="${quest.new}"  class="mb-2">
                                    Статус:
                                    <span th:if="${quest.new}" class="badge bg-success">Новый</span>
                                </p>
                                <a th:href="@{'/quests/' + ${quest.id}}" class="btn btn-primary w-100">
                                    Подробнее
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Пагинация -->
            <div class="pagination">
                <!-- Кнопка "Назад" -->
                <a th:if="${currentPage > 0}"
                   th:href="@{/quests(page=${currentPage - 1})}"
                   class="page-link">← Назад</a>

                <!-- Номера страниц -->
                <a th:each="page : ${#numbers.sequence(0, totalPages - 1)}"
                   th:href="@{/quests(page=${page})}"
                   th:text="${page + 1}"
                   th:class="${page == currentPage} ? 'page-link active' : 'page-link'">
                </a>

                <!-- Кнопка "Вперед" -->
                <a th:if="${currentPage < totalPages - 1}"
                   th:href="@{/quests(page=${currentPage + 1})}"
                   class="page-link">Вперед →</a>
            </div>

        </div>
    </appMain>

</th:block>